<script type="text/javascript">
$(document).ready(function() {
    var pathname = window.location;
    var page = window.location.href;
    var silpaInstallation = page.substring(0,page.lastIndexOf('/')+1);
    var jsonRequest = {
        "method" :  "modules.Webfonts.get_fonts_list",
         "params" : [], 
         "id" : ""
    };
    $.ajax({
        type: "POST",
        contentType: "application/json; charset=utf-8",
        url: "JSONRPC",
        data: $.toJSON(jsonRequest), 
        dataType: "json",
        success: function(msg) {
          var resultobj =eval( '(' + msg.result + ')');
          $('#progress').html("Loading fonts list...");
            // Render it
            $('#fontslist').append("<table id='resulttable' class='table1'><tr><th>Font Name</th><th>Language</th><th>CSS Link</th><th>Font Preview</th><th>Download</th></tr></table>");
            var fonts = resultobj["Fonts"];
            $("head").append("<style>");
            var style = $("head").children(":last");
            style.attr({
              type: "text/css"
            });
            
            for(var index in fonts){
              var font = fonts[index];
              var font_details = resultobj[font];
              var css_link = pathname + "?font="+font;

              $("head").append("<link>");
              css = $("head").children(":last");
              css.attr({
                rel: "stylesheet",
                type: "text/css",
                href: css_link
              });

              style.append("."+ font +"{ font-family:"+ font +",sans; font-size: 16px;}");
              
               $('#resulttable tr:last').after("<tr><td>" + font +"</td><td>" + font_details["Language"] + "</td><td><a href='" + css_link +"'>"+ css_link + "</td><td><p class="+ font +">" + font_details["SampleText"] + "</p></td><td><a href="+ silpaInstallation +"modules/webfonts/font/"+ font +".ttf>"+ font  +".ttf</a></td></tr>" );
               $('#progress').html("Loading font "+ fonts[index] );
               $('#previewfont').append(
                        $('<option></option>').val(font).html(font+" - "+font_details["Language"])         );

            }
           
            $('#fontslist').append("<br/>");
            $('#progress').html("" );
        },
        error: function(msg) { alert(msg); }
    });
});    

function previewFont(dropdown){
    var font = dropdown.options[dropdown.selectedIndex].value;
    $("#result").html($("#previewtext").val());
    $("#result").css('font-family', font) ;
    $("#result").css('font-size', '10px');
}

</script>
<body>
        <h2>Webfonts</h2>
        </hr>
        <p>Webfonts allows web designers to use custom fonts in the pages without having the fonts installed in users computer.
        This technique make usr of @font-face feature. Any modern webbrowser is capable of using webfonts
        </p>
        <p>
        Silpa provides a set of indic fonts that you can use in your webpages. Users can see the pages in Indic languages even if the
        font is not availabe in their computer. Silpa webfonts module simplifies the usage of webfonts for developers by hosting
        available opensource fonts in our sever and providing the easy to use css links.
        </p>
        <h3>Avaialable Fonts</h3>
        <div id="fontslist"></div>
        <div id="progress"></div>
        <h3>How to use webfont in your website</h3>
        <p>To embed a font say,Meera into your web page, copy the css link from above table as the first element in the &lt;head&gt; of your html document.<p>
        <p>The API will generate the necessary CSS specific to the user's browser so you
        can use the font on your page. Simply use the font Meera in your CSS font stack like any other font,
        for example:</p>
        <code>
        p { font-family: 'Meera',sans; }
        </code>
        <br/>
        <h2>Preview your own text</h2>
        <textarea id="previewtext"></textarea>
        <select id='previewfont' onchange="previewFont(this);"> <option value="none">Select Font</option></select>
  <hr/>
  <div id="successmessage"></div>
  <div id="errormessage"></div>
  <div id="result"></div>
 </body>
